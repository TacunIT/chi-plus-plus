<!DOCTYPE html>
<html lang="it-IT"><head>
    <title>Il debug |  C'hi++
</title>
    <meta charset="utf-8" />
    <meta name="viewport"     content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
    <link rel="canonical"            href="https://chiplusplus.org" />
    <meta     name="thumbnail"       content="https://chiplusplus.org/assets/img/chi-plus-plus.png" />
    <meta     name="keyword"         content="C'hi, C++, c plus plus, religione, open-source" />
    <meta     name="description"     content="Chi++ - Proposta per una metafisica open-source" />
    <meta property="og:title"        content="Il debug" />
    <meta property="og:type"         content="website" />    
    <meta property="og:description"  content="Chi++ - Proposta per una metafisica open-source" />
    <meta property="og:image"        content="https://chiplusplus.org/assets/img/chi-plus-plus.png" />
    <meta property="og:image:height" content="260" />
    <link rel=icon href=/assets/img/favicon.ico type=image/x-icon>
    <link href="/assets/fa/css/all.css" rel="stylesheet"> 
    <link rel="stylesheet" href="/assets/css/screen.css" ><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-159394431-1');
</script></head>
<body class="manuale capitolo ">

    <div id="page">

        <header><nav class="menu-top">
    
    <a title="Vai a: Gli stream" 
        
        href="/man/stream" 
        class="left"
        
       >
       <i class="fa fa-chevron-left fa-2x" aria-hidden="true"></i>
    </a>
    
    <a href="/" class="center" title="Torna alla home-page">
        <i class="fa fa-home fa-2x" aria-hidden="true"></i>
    </a>
    <a href="/man/indice" class="center" title="Torna all'indice del Manuale">
        <i class="fa fa-bars fa-2x" aria-hidden="true"></i>
    </a>

    <a title="Vai a: Epilogo" 
        
        href="/man/epilogo" 
        
        class="right" 
        >
        <i class="fa fa-chevron-right  fa-2x" aria-hidden="true"></i>
    </a>
    
</nav>
</header>

        <main class="redazione">
            
        

            <h1>
                Il debug
            </h1>

            <blockquote class="motto">Cento Mondi di peccato sono dissipati dalla luce di un solo ticket</blockquote>

            <section id="testo">

                <p>Il debug potrà non essere il senso della vita, come recita il titolo del tuo libro, ma è indubbiamente l’aspetto più importante della programmazione.</p>

<p>Nella tua carriera di programmatore potrai non utilizzare mai una classe <em>functor</em> o ridefinire l’operatore <code>-&gt;</code>, ma sicuramente farai degli errori e li dovrai correggere.
Malgrado ciò, i manuali di programmazione non parlano mai del <em>debug</em>.<br />
Si sono scritte migliaia di pagine sui diversi linguaggi di programmazione; non c’è primavera che non veda fiorire un nuovo paradigma di programmazione — strutturata, <em>object-oriented</em>, <em>agile</em>, <em>fuzzy</em> — eppure, nessuno si è mai preoccupato di formalizzare il processo di correzione del codice.<br />
Trascurare il debug è come affermare che non si faranno mai errori.
Non importa quanto sia efficiente il linguaggio di programmazione; non importa quanto sia astuto e vigile il compilatore; non importa nemmeno quanto sia bravo il programmatore: o prima o poi, la distrazione, la stanchezza o un evento esterno permetteranno a un errore di intrufolarsi nel codice.
Un puntatore utilizzato impropriamente, un ciclo in più o in meno in un’istruzione <code>for</code> o una virgola dimenticata fra i parametri di una <code>printf</code>: qualunque cosa sia, se il compilatore non sarà in grado di riconoscerla, finirà nel programma è resterà lì in attesa di produrre i suoi effetti dannosi.
Il programma potrà funzionare correttamente per anni, ma poi, un bel giorno, qualcosa non andrà come sarebbe dovuto andare e a quel punto bisognerà analizzare il codice per trovare l’errore.<br />
Fare degli errori è inevitabile, ed è importante sapere come porvi rimedio.
Ancora più importante, però, è sapersi accorgere degli errori.
Così come <em>l’Ikebarba inizia nel negozio</em>, il debug comincia nel momento in cui si scrive il codice.
Il modo migliore per evitare che il codice contenga degli errori è scrivere del buon codice.
Scrivere del buon codice vuol dire fare sempre il meglio che ti è possibile.
Non salvare mai un file se non sei certo che funzionerà come deve e cerca sempre di pensare a cos’altro potrebbe fare il tuo codice, oltre a quello che vuoi tu.
Come di ho detto <a href="/man/programmatore#buon-programmatore" class="xref">in una delle nostre prime chiacchierate</a>, il buon programmatore non si accontenta della strada più rapida, ma cerca sempre quella più efficiente e sicura, perché sa che scrivere del buon codice costa meno che riparare del codice fatto male.
Il Maestro Canaro, una volta disse:</p>

<blockquote>
  <p>Il buon programmatore è come un marinajo che, prima di un lungo viaggio, verifica tutta la sua attrezzatura di coperta, smontando ogni singolo elemento e sostituendo ciò che potrebbe rompersi, perché non sa cosa succederà una volta che sarà in mare.</p>
</blockquote>

<p>Il buon programmatore non può farne a meno, perché è nella sua natura; è questa, la differenza fra chi <em>fa</em> il programmatore e chi <em>è</em> un programmatore.<br />
La decadenza del software è iniziata quando le stampanti laser hanno soppiantato le vecchie stampanti ad aghi.
Il codice non si può leggere su un foglio A4: a meno che non sia un programma banale, non c’entrerà né in altezza né in larghezza.
Il modulo in continuo di una stampante ad aghi a 136 colonne, al contrario, ti permette di stampare tutto il tuo codice e di rileggerlo con calma; correggerlo, se necessario e migliorarlo se possibile.
È così che si facevano, le revisioni di codice, quando ancora c’erano il tempo e i soldi per fare le revisioni di codice.</p>

<hr id="tipi-errore" />

<p>Gli errori del software possono essere di tre tipi:</p>

<ul>
  <li>gli errori che si manifestano durante la fase di compilazione;</li>
  <li>gli errori che si manifestano durante l’esecuzione del programma;</li>
  <li>gli errori di analisi.</li>
</ul>

<p>Gli <b id="errori-compilazione">errori di compilazione</b> sono causati da costrutti incorretti, che bloccano il processo di creazione del programma. 
Un errore che farai spesso è di dimenticare il punto e virgola alla fine della dichiarazione di una classe:</p>

<pre><code>class C {
private:
    float _raggio;
    float _area;
public:
    C (int m) : _raggio(m) {}
    float getRaggio() { return _raggio; }
    float area() {
       Quadrato q;
       return 3.14159 * q(_raggio);
    }
}
</code></pre>

<p>una banale distrazione che causerà immancabilmente il messaggio:</p>

<pre><code>&gt; g++ src/cpp/debug-errori.cpp  -c -o src/out/esempio 
src/cpp/debug-errori.cpp:28:2: error: expected ';' after class
}
 ^
 ;
1 error generated.
</code></pre>

<p>Gli errori di compilazione sono i più facili da gestire, perché è il compilatore stesso a dirti quale sia il problema e in quale punto del codice si trovi.
L’unica difficoltà che potresti avere, specie se stai lavorando con la <code>STL</code>, è decifrare i messaggi del compilatore:</p>

<pre><code>In file included from /Library/Developer/CommandLineTools/usr/bin/../include/c++/v1/iostream:38:
In file included from /Library/Developer/CommandLineTools/usr/bin/../include/c++/v1/ios:216:
In file included from /Library/Developer/CommandLineTools/usr/bin/../include/c++/v1/__locale:15:
/Library/Developer/CommandLineTools/usr/bin/../include/c++/v1/string:2027:19: error: no viable conversion from
      'const std::__1::basic_string&lt;char&gt;' to 'std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;,
      std::__1::allocator&lt;char&gt; &gt;::value_type' (aka 'char')
        push_back(*__first);
                  ^~~~~~~~
/Library/Developer/CommandLineTools/usr/bin/../include/c++/v1/string:2075:5: note: in instantiation of function
      template specialization 'std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;
      &gt;::__init&lt;std::__1::istream_iterator&lt;std::__1::basic_string&lt;char&gt;, char, std::__1::char_traits&lt;char&gt;, long&gt; &gt;'
      requested here
    __init(__first, __last);
    ^
src/cpp/debug-errori.cpp:43:12: note: in instantiation of function template specialization
      'std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;
      &gt;::basic_string&lt;std::__1::istream_iterator&lt;std::__1::basic_string&lt;char&gt;, char, std::__1::char_traits&lt;char&gt;,
      long&gt; &gt;' requested here
    string s(begin,end);
           ^
/Library/Developer/CommandLineTools/usr/bin/../include/c++/v1/string:876:5: note: candidate function
    operator __self_view() const _NOEXCEPT { return __self_view(data(), size()); }
    ^
/Library/Developer/CommandLineTools/usr/bin/../include/c++/v1/string:1055:31: note: passing argument to parameter
      '__c' here
    void push_back(value_type __c);
</code></pre>
<!-- Grazie, John Berryman https://bit.ly/3vIU4hN -->

<p>Se un costrutto è formalmente corretto, ma <em>potrebbe</em> essere un errore, il compilatore può segnalarlo con un <b id="warning">warning</b>, un messaggio di avviso che non blocca la compilazione, ma richiama l’attenzione del programmatore sull’anomalia.<br />
Ho usato il condizionale (<em>può segnalarlo</em>) perché la notifica dei <em>warning</em> è un’opzione che deve essere attivata dal programmatore, specificando, fra i parametri di compilazione, quali avvisi vuole ricevere.
Dato che i parametri per attivare i diversi tipi di <em>warning</em> sono davvero tanti:</p>

<pre><code>-Waddress   
-Wbool-compare  
-Wbool-operation  
-Wchar-subscripts  
-Wcomment  
-Wformat   
-Wformat-overflow  
-Wformat-truncation  
-Wint-in-bool-context  
-Winit-self  
-Wlogical-not-parentheses 
-Wmaybe-uninitialized 
-Wmemset-elt-size 
-Wmemset-transposed-args 
-Wmisleading-indentation 
-Wmismatched-dealloc 
-Wmismatched-new-delete 
-Wmissing-attributes 
-Wmultistatement-macros  
-Wnarrowing   
-Wnonnull  
-Wnonnull-compare  
-Wopenmp-simd 
-Wparentheses  
-Wpessimizing-move   
-Wpointer-sign  
-Wrange-loop-construct   
-Wreorder   
-Wrestrict   
-Wreturn-type  
-Wsequence-point  
-Wsign-compare   
-Wsizeof-array-div 
-Wsizeof-pointer-div 
-Wsizeof-pointer-memaccess 
-Wstrict-aliasing  
-Wstrict-overflow=1  
-Wswitch  
-Wtautological-compare  
-Wtrigraphs  
-Wuninitialized  
-Wunknown-pragmas  
-Wunused-function  
-Wunused-label     
-Wunused-value     
-Wunused-variable  
-Wvolatile-register-var  
-Wzero-length-bounds
</code></pre>

<p>e che possono essere tutti rilevanti nel processo di creazione del codice, la cosa migliore che puoi fare è di attivarli globalmente, con il parametro: <code>-Wall</code></p>

<pre><code>/** 
 * @file src/debug-errori-warning.cpp
 * Tipi di errore e di warning.
 */

#include &lt;iostream&gt;

using namespace std;

class Quadrato
{
public:
    double operator()(double x) { return x * x; }
};

class C {
private:
    float _raggio;
    float _area;
public:
    C (int m) : _raggio(m) {}
    float getRaggio() { return _raggio; }
    float area() {
       Quadrato q;
       return 3.14159 * q(_raggio);
    }
};

int main(int argc, char** argv) 
{
    C c(10);    
    cout &lt;&lt; c.area() &lt;&lt; endl;
    return 0;
}

</code></pre>

<p>Se compili questo codice senza attivare i <em>warning</em>, il compilatore non ti segnala nulla di anomalo:</p>

<pre><code>&gt; g++ src/cpp/debug-errori-warning.cpp -c -o src/out/esempio
&gt; 
</code></pre>

<p>Se però aggiungi il parametro <code>-Wall</code> alla riga di comando, scopri che il parametro <code>_area</code> della classe <code>C</code> non viene utilizzato:</p>

<pre><code>&gt; g++ src/cpp/debug-errori-warning.cpp -Wall -c -o src/out/esempio
src/cpp/debug-errori-warning.cpp:19:11: 
    warning: private field '_area' is not used 
        [-Wunused-private-field]
    float _area;
          ^
1 warning generated.
</code></pre>

<p>Il codice è stato compilato, perché questa potrebbe essere una scelta intenzionale, ma il sistema ti notifica comunque l’anomalia, in modo che tu possa decidere se mantenerla o eliminarla.<br />
Aggiungendo il parametro <code>-Wextra</code>, ottieni un <em>warning</em> aggiuntivo perché i parametri della funzione <code>main</code> non sono utilizzati:</p>

<pre><code>&gt; g++ src/cpp/debug-errori-warning.cpp -Wall -Wextra -o src/out/esempio
src/cpp/debug-errori-warning.cpp:29:14: 
    warning: unused parameter 'argc' 
        [-Wunused-parameter]
int main(int argc, char** argv) 
             ^
src/cpp/debug-errori-warning.cpp:29:27: 
    warning: unused parameter 'argv' 
        [-Wunused-parameter]
int main(int argc, char** argv) 
                          ^
src/cpp/debug-errori-warning.cpp:19:11: 
    warning: private field '_area' is not used 
        [-Wunused-private-field]
    float _area;
          ^
3 warnings generated.
</code></pre>

<p>Oltre a quelli definiti dai parametri <code>-Wall</code> e <code>-Wextra</code>, il compilatore prevede una lunga lista di <em>warning</em> che possono essere definiti individualmente, a seconda delle esigenze del programma. 
Per esempio, il parametro <code>-Wdouble-promotion</code> segnala quando una variabile di tipo <code>float</code> è promossa implicitamente a <code>double</code>:</p>

<pre><code>&gt; g++ src/cpp/debug-errori-warning.cpp -Wall -Wextra \
    -Wdouble-promotion -c -o src/out/esempio
src/cpp/debug-errori-warning.cpp:25:27: 
    warning: implicit conversion increases 
        floating-point precision: 'float' to
      'double' [-Wdouble-promotion]
       return 3.14159 * q(_raggio);
                        ~ ^~~~~~~
src/cpp/debug-errori-warning.cpp:29:14: 
    warning: unused parameter 'argc' [-Wunused-parameter]
int main(int argc, char** argv) 
             ^
src/cpp/debug-errori-warning.cpp:29:27: 
    warning: unused parameter 'argv' [-Wunused-parameter]
int main(int argc, char** argv) 
                          ^
src/cpp/debug-errori-warning.cpp:19:11: 
    warning: private field '_area' is not used 
        [-Wunused-private-field]
    float _area;
          ^
4 warnings generated.
</code></pre>

<p>Molti programmatori ignorano i <em>warning</em>, pensano che se il programma può essere compilato non ci sia nient’altro di cui preoccuparsi.
Tu non fare questo errore: nessun avviso deve essere ignorato.</p>

<hr id="errori-esecuzione" />

<p>Solo un programma formalmente ineccepibile può dare luogo a <strong>errori di esecuzione</strong>.
Se non fosse formalmente ineccepibile, infatti, non sarebbe stato compilato e non potrebbe essere eseguito.<br />
Gli errori di esecuzione sono tanto più pericolosi quanto più i loro
effetti sono lievi.
Un errore che causi il blocco del sistema sarà certamente rilevato e corretto; al contrario, un leggero errore di calcolo potrebbe passare inosservato e
quindi causare grandi problemi.<br />
Se dimentichi l’operatore di incremento all’interno di un ciclo <code>while</code> produrrai un ciclo infinito, che certamente attirerà la tua attenzione:</p>

<pre><code>/** 
 * @file pianeti-while-errore.cpp
 * Gestione dei Pianeti con errore evidente.
 */
 
#include &lt;iostream&gt;
#include "pianeti.h"

using namespace std;

int main(int argc, char** argv)
{    
    int    p  = POS_MERCURIO;
    string nome;

    while (!(nome = nomePianeta(p)).empty()) {
        cout &lt;&lt; nome &lt;&lt; endl;
    }
        
    return 0;
}

</code></pre>

<pre><code>&gt; g++ src/cpp/pianeti-while-errore-1.cpp \
      src/cpp/pianeti-2.0.cpp \
   -o src/out/esempio
&gt; src/out/esempio
Mercurio
Mercurio
Mercurio
Mercurio
Mercurio
Mercurio
Mercurio
Mercurio
Mercurio
Mercurio
Mercurio
...
</code></pre>

<p>Se invece incrementi la variabile nel modo sbagliato:</p>

<pre><code>/** 
 * @file pianeti-while-errore.cpp
 * Gestione dei Pianeti con errore nel ciclo while
 */
 
#include &lt;iostream&gt;
#include "pianeti.h"

using namespace std;

int main(int argc, char** argv)
{    
    int    p  = POS_MERCURIO;
    string nome;

    while (!(nome = nomePianeta(++p)).empty()) {
        cout &lt;&lt; nome &lt;&lt; endl;
    }
        
    return 0;
}

</code></pre>
<p>causerai un errore che, in questo caso, è evidente, perché all’elenco manca Mercurio, ma che in un programma più complesso potrebbe essere difficile da individuare:</p>

<pre><code>&gt; g++ src/cpp/pianeti-while-errore-2.cpp \
      src/cpp/pianeti-2.0.cpp \
   -o src/out/esempio
&gt; src/out/esempio
Venere
Terra
Marte
Giove
Saturno
Urano
Nettuno
Plutone
</code></pre>

<p>Gli errori di esecuzione possono essere di due tipi: quelli che si
manifestano in maniera deterministica e quelli che si manifestano in
maniera casuale.
L’errore nell’elenco dei pianeti si manifesterà a ogni esecuzione del programma e sarà quindi (relativamente) facile da individuare.
Al contrario, questo codice produrrà un errore solo in determinate condizioni:</p>

<pre><code>/** 
 * @file debug-errore-stocastico.cpp
 * Gestione dei Pianeti con errore evidente.
 */
 
#include &lt;iostream&gt;
#include &lt;fstream&gt;

using namespace std;

#define ERR_FILE_NONE       -10
#define ERR_FILE_OPEN       -20
#define S_ERR_FILE_NONE     "Definire un file di input"
#define S_ERR_FILE_OPEN     "Impossibile aprire il file di input"
#define N_CHAR_MIN          300
#define N_BANNER_MAX        3
#define PUNTO               '.'

/**
*   Aggiunge un banner dopo ogni punto, 
*   ogni N_CHAR_MIN caratteri.
*/
int banner_testo(ifstream&amp; testo)
{
    int  n_banner = 1;
    int  letti = 0;
    char c = 0;
 
    /** 
    *  Legge tutto il contenuto del file di input
    */
    while(testo.good()) {
        
        /** 
        *   Legge il cotenuto del file, 
        *   carattere per carattere 
        */
        if((c = testo.get()) != EOF) {            

            /** Incrementa il numero di caratteri letti */
            letti++;

            /** Scrive il carattere letto */
            cout &lt;&lt; c;            

            /** 
            *   Se il carattere corrente è un punto
            *   e ha letto almeno N_CHAR_MIN caratteri
            *   e ha ancora banner da aggiungere, 
            *   inserisce il codice del banner nel testo. 
            */
            if(c == PUNTO 
            &amp;&amp; letti &gt;= N_CHAR_MIN 
            &amp;&amp; n_banner &lt;= N_BANNER_MAX) {                
                cout &lt;&lt; endl 
                     &lt;&lt; "&lt;div id=\"banner-" 
                     &lt;&lt; n_banner 
                     &lt;&lt; "\"&gt;&lt;/div&gt;" 
                     &lt;&lt; endl;
                n_banner++;
                letti = 0;
            }
        }       
    } 
    
    cout &lt;&lt; endl;
    
    return n_banner;
} 
 
int main(int argc, char** argv)
{    
    ifstream testo;
    
    /** Verifica che ci sia il nome del file di input */
    if(argc &lt; 2) {
        cerr &lt;&lt; S_ERR_FILE_NONE &lt;&lt; endl;
        exit(ERR_FILE_NONE);
    }
    
    /** Apre il file in lettura */
    testo.open(argv[1]);
    if(!testo.good()) {
        cerr &lt;&lt; S_ERR_FILE_OPEN &lt;&lt; endl;
        exit(ERR_FILE_OPEN);
    }

    /** Elabora il testo */
    banner_testo(testo);
    
    /** Chiude il file */
    testo.close();
    
    return 0;
}

</code></pre>

<p>La funzione <code>banner_testo</code> inserisce il <em>tag</em> HTML di un banner all’interno del testo di una pagina Web.
I banner devono essere posizionati dopo un punto fermo, a distanza di almeno <code>N_CHAR_MIN</code> caratteri l’uno dall’altro.<br />
Questo codice funziona correttamente con alcuni tipi di testo:</p>

<blockquote class="output">
Essere un ossessivo-compulsivo con una leggera tendenza alla paranoia, se ti guadagni da vivere facendo l’esperto di sicurezza, è un bene; le medesime peculiarità caratteriali, al contrario, sono decisamente un male quando alle 21:55 la tua donna di servizio ti scrive: "Ho fatto un molecolare e sono risultata positiva.
<div id="banner-1"></div>
Non potrai farti un tampone prima delle 8:00 dell’indomani quindi sai che ti aspettano almeno dieci ore di panico controllato; qualcuna di meno, se riesci ad addormentarti.
Cerchi di distrarti guardando la televisione, ma l’ennesimo thriller con Jason Statham, intervallato da pubblicità di ansiolitici (un conflitto di interessi che ti riprometti di studiare con più attenzione, se sopravvivi), non fa che aumentare la tua agitazione; così, spegni il televisore, ti prepari una tisana relax, leggi un po’ e poi cerchi di dormire.
<div id="banner-2"></div>
Appena chiudi gli occhi, però, il tuo cervello comincia a fare ciò che sa fare meglio, ovvero analizzare ciclicamente tutte le possibili conseguenze di un determinato evento; solo che stavolta, quello che potrebbe essere infetto non è un computer, sei tu.
Notizia buona: non hai sintomi. Notizia cattiva: hai visto la tua donna di servizio solo quattro giorni prima, quindi i giochi sono ancora aperti.
<div id="banner-3"></div>
 </blockquote>

<p>Il codice della funzione <code>banner_testo</code>, però, è troppo ottimistico e delle piccole variazioni nel file di input, come l’aggiunta di punti di sospensione o di una URL, <em>potrebbero</em> causare degli errori:</p>

<blockquote class="output">
Essere un ossessivo-compulsivo con una leggera tendenza alla paranoia, se ti guadagni da vivere facendo l’esperto di sicurezza, è un bene; le medesime peculiarità caratteriali, al contrario, sono decisamente un male quando alle 21:55 la tua donna di servizio ti scrive: "Ho fatto un molecolare e sono risultata positiva".
<div id="banner-1"></div>
..
Non potrai farti un tampone prima delle 8:00 dell’indomani quindi sai che ti aspettano almeno dieci ore di panico controllato. Qualcuna di meno, se riesci ad addormentarti.
Cerchi di distrarti guardando la televisione, ma l’ennesimo thriller con Jason Statham, intervallato da pubblicità di ansiolitici (un conflitto di interessi che ti riprometti di studiare con più attenzione, se sopravvivi), non fa che aumentare la tua agitazione; così, spegni il televisore, ti prepari una tisana relax, &lt;a href="http://cplusplus.
<div id="banner-2"></div>
org"&gt;leggi un po’&lt;/a&gt; e poi cerchi di dormire.
</blockquote>

<p>Questo tipo di errori possono aspettare anni, prima di venire alla luce.
Per esempio, un errore nella valutazione di una data in coincidenza con gli anni bisestili potrebbe aspettare quattro anni prima di manifestarsi; nel frattempo, il codice sarà stato distribuito agli utenti e chi lo ha scritto ne avrà perso memoria o potrebbe addirittura aver cambiato lavoro.<br />
La correzione dell’errore della funzione <code>banner_testo</code>, se fatta per tempo, richiederebbe solo l’aggiunta di una condizione all’istruzione <code>if</code>, per verificare che il punto si trovi prima di un a capo:</p>

<pre><code>if(c == PUNTO 
&amp;&amp; letti &gt;= N_CHAR_MIN 
&amp;&amp; n_banner &lt;= N_BANNER_MAX
&amp;&amp; testo.peek() == A_CAPO) { 
    cout &lt;&lt; endl 
         &lt;&lt; "&lt;div id=\"banner-" &lt;&lt; n_banner &lt;&lt; "\"&gt;"
         &lt;&lt; "&lt;/div&gt;" 
         &lt;&lt; endl;
    n_banner++;
    letti = 0;
}
</code></pre>

<p>La stessa correzione, fatta dopo che il programma è andato in esercizio, potrebbe richiedere giorni, se non settimane, perché dovrà essere ripetuto tutto il processo di rilascio del sistema:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">attività</th>
      <th style="text-align: center">ore/uomo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">creazione di un ambiente di test</td>
      <td style="text-align: center">8</td>
    </tr>
    <tr>
      <td style="text-align: left">debug</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: left">correzione dell’errore</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: left">test funzionale</td>
      <td style="text-align: center">4</td>
    </tr>
    <tr>
      <td style="text-align: left">test di carico</td>
      <td style="text-align: center">8</td>
    </tr>
    <tr>
      <td style="text-align: left">test di sicurezza</td>
      <td style="text-align: center">8</td>
    </tr>
    <tr>
      <td style="text-align: left">collaudo</td>
      <td style="text-align: center">4</td>
    </tr>
    <tr>
      <td style="text-align: left">rilascio/distribuzione</td>
      <td style="text-align: center">1</td>
    </tr>
  </tbody>
</table>

<p>Al costo di queste attività vanno ovviamente aggiunti i possibili danni derivanti dal mancato funzionamento del sistema, che potrebbero facilmente essere pari a un mese se non a un anno di stipendio del programmatore.<br />
Devi pensare a tutto questo, quando scrivi codice, perché hai una responsabilità sia nei confronti del tuo datore di lavoro che degli utenti del sistema, che potrebbero essere anche i tuoi amici o i tuoi parenti.<br />
Se lavori male per la Coca-Cola, puoi sempre pensare: “Chi se ne frega, io bevo Pepsi”; non è etico, ma almeno non è auto-lesionista. 
Se però lavori male per lo Stato, stai peggiorando la tua vita e di tutte le persone che conosci e questo, oltre a non essere etico, è anche stupido.</p>

<hr />

<p>Un programma per il debug può aiutarti a identificare il punto del tuo codice che genera un errore, ma devi prima capire quale sia la funzione da esaminare, perché fare il debug di tutto il codice di un programma, laddove sia possibile, sarebbe estremamente frustrante.<br />
Il modo in cui hai scritto il codice lo renderà più o meno facile da verificare.
Immagina che il problema sia il valore della variabile <code>x</code>: se tutto il tuo codice ha la possibilità di modificarne il valore, potresti dover esaminare ogni singola funzione per verificare che non ne faccia un uso improprio. 
Al contrario, se la variabile <code>x</code> potrà essere modificata solo alcuni punti del codice, la tua sarà una ricerca più mirata e veloce. 
È per questo motivo, che <a href="/man/istruzioni-iterative#isolamento-funzionale" class="xref">nella lezione sulle funzioni iterative</a> abbiamo diviso l’elaborazione dei dati dalla gestione dell’interfaccia utente: perché in questo modo, a seconda dell’errore che dovesse verificarsi, sapremmo subito dove andare a guardare.<br />
Alcune caratteristiche del C++, come la <a href="/man/note.html#tipizzazione" class="xref">tipizzazione forte</a> e l’<a href="/man/note.html#incapsulamento" class="xref">incapsulamento</a> potranno esserti di aiuto, in questo, ma non sempre saranno sufficienti.
L’errore si manifesterà — di solito pochi minuti prima che tu debba smettere di lavorare per uscire o fare qualcos’altro — e tu dovrai identificarne la causa.
Il primo problema sarà riuscire a riprodurre le condizioni in cui l’errore di manifesta.
Come abbiamo visto poco fa, se l’errore dipende dai dati in input, prima ancora di identificare il problema, dovrai capire quali siano i dati che lo generano. 
Diversi anni or sono, il Maestro Canaro dovette registrarsi su un sito Web che gli chiese anche la sua data di nascita (che, come sai, fu il 29 Febbraio del 1964).
<!-- Si trattava di Paypal e questo non è il solo errore che ho rilevato -->
La maschera di inserimento nuovo utente non gli diede problemi, ma la maschera di modifica dati, evidentemente scritta da un programmatore meno esperto, non gli permise di aggiornarli perché, a suo dire, la data di nascita era sbagliata.
Ciò vuol dire che il sistema utilizzava due funzioni distinte per il controllo della data di nascita nelle funzioni di inserimento e modifica e che la funzione utilizzata in modifica non era una funzione standard, ma codice scritto <em>ad-hoc</em>.<br />
Entrambe queste scelte sono errori: a una determinata azione sui dati deve corrispondere una singola funzione.
Fare la stessa operazione con parti di codice distinte è sbagliato, sia perché aumenta la probabilità di commettere degli errori, sia perché rallenta i tempi di identificazione dell’errore in fase di debug.
È sbagliato anche riscrivere delle funzioni che già esistono: <a href="http://cr.yp.to/djb.html" target="qmail">D. J. Bernstein</a> lo fece, con le funzioni di I/O di qmail, ma le sue funzioni erano migliori e più sicure delle funzioni della libreria standard.   <br />
A questi due errori di programmazione — inammissibili, in un sito che gestisce transazioni economiche — si aggiunge una profonda sciatteria della fase di debug del codice, perché la corretta gestione dei casi particolari, come gli anni bisestili, va sempre verificata.</p>

<!--

v. Orologiaio, pos. 3836 

Il cambiamento inizia quando si intraprende un nuovo sentiero , anche se questo sentiero non è che una traccia lasciata da una capra assetata che ha trovato una sorgente .
M. Deen - Per antiche strade

Se non lo si è fatto finora, spiegare che gli esempii del testo sono studiati per essere progressivamente migliorati, per dimostrare come la scrittura di codice sia un'attività in continua evoluzione.

-->


            </section>
            
        

        
        </main>

        <footer>
    <nav>
        
        
        <a href="/man/stream" 
           title="Vai a: Gli stream" 
           class="left">
            <i class="fa fa-chevron-left fa-2x" aria-hidden="true"></i>
        </a>
        
        
        <a href="#top" 
           title="Torna all'inizio" >
           <i class="fa fa-angle-double-up fa-2x" aria-hidden="true"></i>
        </a>

        
        <a href="/man/epilogo" 
           title="Vai a: Epilogo" 
           class="right" >
                <i class="fa fa-chevron-right  fa-2x" aria-hidden="true"></i>
        </a>
                

    </nav>

</footer>


    </div>

  </body>

</html>
