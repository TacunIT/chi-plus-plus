<!DOCTYPE html>
<html lang="it-IT"><head>
    <title>Gli stream |  C'hi++
</title>
    <meta charset="utf-8" />
    <meta name="viewport"     content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
    <link rel="canonical"            href="https://chiplusplus.org" />
    <meta     name="thumbnail"       content="https://chiplusplus.org/assets/img/chi-plus-plus.png" />
    <meta     name="keyword"         content="C'hi, C++, c plus plus, religione, open-source" />
    <meta     name="description"     content="Chi++ - Proposta per una metafisica open-source" />
    <meta property="og:title"        content="Gli stream" />
    <meta property="og:type"         content="website" />    
    <meta property="og:description"  content="Chi++ - Proposta per una metafisica open-source" />
    <meta property="og:image"        content="https://chiplusplus.org/assets/img/chi-plus-plus.png" />
    <meta property="og:image:height" content="260" />
    <link rel=icon href=/assets/img/favicon.ico type=image/x-icon>
    <link href="/assets/fa/css/all.css" rel="stylesheet"> 
    <link rel="stylesheet" href="/assets/css/screen.css" ><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-159394431-1');
</script></head>
<body class="manuale capitolo ">

    <div id="page">

        <header><nav class="menu-top">
    
    <a title="Vai a: Il polimorfismo" 
        
        href="/man/polimorfismo" 
        class="left"
        
       >
       <i class="fa fa-chevron-left fa-2x" aria-hidden="true"></i>
    </a>
    
    <a href="/" class="center" title="Torna alla home-page">
        <i class="fa fa-home fa-2x" aria-hidden="true"></i>
    </a>
    <a href="/man/indice" class="center" title="Torna all'indice del Manuale">
        <i class="fa fa-bars fa-2x" aria-hidden="true"></i>
    </a>

    <a title="Vai a: Il debug" 
        
        href="/man/debug" 
        
        class="right" 
        >
        <i class="fa fa-chevron-right  fa-2x" aria-hidden="true"></i>
    </a>
    
</nav>
</header>

        <main class="bozza">
            
        

            <h1>
                Gli stream
            </h1>

            <blockquote class="motto">Non puoi immergere i tuoi byte due volte nello stesso stream</blockquote>

            <section id="testo">

                <p>Oggi ti parlerò della componente più importante del C++, ovvero gli <em>stream</em>.</p>

<pre><code>/** 
 * @file 
 * 
 */
 
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;exception&gt;

using namespace std;

#define ERR_NONE              0
#define ERR_FILE_NONE       -10
#define ERR_FILE_OPEN       -20
#define ERR_FILE_READ       -30
#define S_ERR_FILE_NONE     "Definire un file di input"
#define S_ERR_FILE_OPEN     "Impossibile aprire il file di input"
#define S_ERR_FILE_READ     "Impossibile leggere il file di input"

class Eccezione: public exception
{
private:
    int         _codice;
    const char* _errore;
public:

    Eccezione(int codice, const char* errore) 
    : _codice(codice), _errore(errore) {        
    }
    
    virtual const char* what() const throw() {
        return _errore;
    }

    int getCodice() { return _codice; }
    
    friend ostream&amp; operator&lt;&lt; (ostream&amp; os, Eccezione e){
        os &lt;&lt; endl &lt;&lt; e._codice &lt;&lt; ": " &lt;&lt; e._errore &lt;&lt; endl;
        return os;
    }
};

void errore(int codice, bool exit = true)
{
    const char* errore = NULL;
    
    switch(codice) {
        case ERR_FILE_NONE: errore = S_ERR_FILE_NONE; break;
        case ERR_FILE_OPEN: errore = S_ERR_FILE_OPEN; break;                
        case ERR_FILE_READ: errore = S_ERR_FILE_READ; break;                
    }
    if(errore != NULL   ){
        Eccezione e(codice, errore);
        throw e;
    }
}

int verifica_parametri(int argc, char** argv)
{
    return (argc &lt; 2) ? ERR_FILE_NONE : ERR_NONE;
} 

int apri_file(ifstream&amp; testo, const char* path)
{
    // cout &lt;&lt; "Apro il file: " &lt;&lt; path;
    testo.open(path);
    return ERR_NONE;
} 

int elabora_file(ifstream&amp; testo)
{
    int  letti = 0;
    char c = 0;
    while(testo.good()) {
        if((c = testo.get()) != EOF) {            
            letti++;
            cout &lt;&lt; c;            
        }       
    } 
    return letti;
} 

void chiudi_file(ifstream&amp; testo)
{
    testo.close();
} 
 
int main(int argc, char** argv)
{    
    ifstream testo;
    testo.exceptions ( std::ifstream::badbit );

    try {
        
        int esito = ERR_NONE;
        
        /** Verifica che ci sia il nome del file di input */
        esito = verifica_parametri(argc, argv);
        errore(esito);
        
        /** Apre il file in lettura */
        try {
            esito = apri_file(testo, argv[2]);            
        } catch(ifstream::failure e) {
            errore(ERR_FILE_OPEN);            
        }
        
        /** Elabora il testo */
        if(elabora_file(testo) == 0)
            errore(ERR_FILE_READ);
        
        /** Chiude il file */
        chiudi_file(testo);
    
    } catch (Eccezione e) {
        cerr &lt;&lt; e;
        exit(e.getCodice());
    }
    
    return 0;
}

</code></pre>

<!--

@todo: introdurre la gestione delle eccezioni

-->


            </section>
            
        

        
        </main>

        <footer>
    <nav>
        
        
        <a href="/man/polimorfismo" 
           title="Vai a: Il polimorfismo" 
           class="left">
            <i class="fa fa-chevron-left fa-2x" aria-hidden="true"></i>
        </a>
        
        
        <a href="#top" 
           title="Torna all'inizio" >
           <i class="fa fa-angle-double-up fa-2x" aria-hidden="true"></i>
        </a>

        
        <a href="/man/debug" 
           title="Vai a: Il debug" 
           class="right" >
                <i class="fa fa-chevron-right  fa-2x" aria-hidden="true"></i>
        </a>
                

    </nav>

</footer>


    </div>

  </body>

</html>
